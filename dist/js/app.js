!function(e){var t={};function s(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,s),o.l=!0,o.exports}s.m=e,s.c=t,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)s.d(r,o,function(t){return e[t]}.bind(null,o));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="",s(s.s=6)}([function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Selector=class{constructor(e){this.query=e}get element(){const e=document.querySelector(this.query);if(null===e)throw new Error("DOM not found with selector."+this.query);return e}get elements(){return document.querySelectorAll(this.query)}get htmlElement(){const e=this.element;if(null===e)throw new Error("DOM is not HTMLElement.");return e}get htmlElements(){return document.querySelectorAll(this.query)}isGenerated(){return null!==document.querySelector(this.query)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.MessageManager=class{setListener(e){chrome.runtime.onMessage.addListener(e)}send(e){chrome.runtime.sendMessage(e)}sendToActiveTab(e){chrome.tabs.query({active:!0,currentWindow:!0},t=>{void 0!==t[0]&&null!=t[0].id&&chrome.tabs.sendMessage(t[0].id,e)})}},function(e){e.SET_OVERLAY_MODE="set-overlay-mode",e.UPDATE_ICON="update-icon"}(t.MessageType||(t.MessageType={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.OverlayMode=class{constructor(){this.overlayClass="overlay-mode"}get isOverlay(){return document.body.classList.contains(this.overlayClass)}get class(){return this.overlayClass}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o;t.Page=class{getIsOverlayMode(e,t){null!=e.id&&chrome.pageAction.getTitle({tabId:e.id},e=>{t(e==o.ENABLED)})}updateMode(e,t,s){this.updateIcon(e,t,()=>{this.updateTitle(e,t,s)})}updateIcon(e,t,s){null!=e.id&&chrome.pageAction.setIcon({path:t?r.ENABLED:r.DISABLED,tabId:e.id},s)}updateTitle(e,t,s){null!=e.id&&chrome.pageAction.setTitle({title:t?o.ENABLED:o.DISABLED,tabId:e.id},s)}},function(e){e.ENABLED="../icons/16.png",e.DISABLED="../icons/off.png"}(r||(r={})),function(e){e.ENABLED="disable overlay mode",e.DISABLED="enable overlay mode"}(o||(o={}))},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Storage=class{constructor(){this.keyPrefix="chat-overlayer-for-youtube-"}get(e){return window.localStorage.getItem(this.keyPrefix+e)}set(e,t){window.localStorage.setItem(this.keyPrefix+e,t)}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.PlayerModeManager=class{get isDefault(){const e=this.element;return null===e||e.classList.contains("player-default")}get isTheater(){const e=this.element;return null!==e&&e.classList.contains("player-theater")}get isFullscreen(){const e=this.element;return null!==e&&e.classList.contains("player-fullscreen")}get element(){return document.getElementById("chat")}}},function(e,t,s){s(7),e.exports=s(17)},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(8);let o=null;new MutationObserver(e=>{for(let t=0;t<e.length;t++)Array.from(e[t].addedNodes).filter(e=>"YTD-LIVE-CHAT-FRAME"===e.nodeName).some(()=>(o=r.App.tryNew(),!0)),Array.from(e[t].removedNodes).filter(e=>"YTD-LIVE-CHAT-FRAME"===e.nodeName).some(()=>(null!==o&&(o.dispose(),o=null),!0))}).observe(document.body,{childList:!0,subtree:!0})},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(9),o=s(13),n=s(14),l=s(15),i=s(16),a=s(1),c=s(2),u=s(3),d=s(5),h=s(0),y=s(4);class m extends h.Selector{constructor(){super("body"),this.cookies=new i.Cookies,this.overlayMode=new c.OverlayMode,this.page=new u.Page,this.playerModeManager=new d.PlayerModeManager,this.storage=new y.Storage,this.messageManager=new a.MessageManager,this.chatSelector=new r.ChatSelector,this.chatAppFrameSelector=new o.ChatAppFrameSelector,this.sizeButtonSelector=new l.SizeButtonSelector,this.fullscreenButtonSelector=new n.FullscreenButtonSelector;const e=()=>{this.playerModeManager.isFullscreen?(this.cookies.update(),console.log(this.cookies.isWide),this.cookies.isWide?this.chatSelector.setPlayerMode(1):this.chatSelector.setPlayerMode(0)):this.chatSelector.setPlayerMode(2)};this.sizeButtonSelector.setOnclick(()=>{this.playerModeManager.isDefault?this.chatSelector.setPlayerMode(1):this.chatSelector.setPlayerMode(0)}),this.fullscreenButtonSelector.setOnclick(e),this.chatSelector.setPlayerOndbclick(e),this.initialize()}initialize(){this.refreshOverlayMode(),this.cookies.isWide?this.chatSelector.setPlayerMode(1):this.chatSelector.setPlayerMode(0),this.messageManager.setListener(e=>{switch(e.type){case a.MessageType.SET_OVERLAY_MODE:const t=e.data.isOverlayMode;this.changeOverlayMode(t)}})}refreshOverlayMode(){let e=this.storage.get("overlay-mode");null==e&&(e="true");const t="true"==e;this.changeOverlayMode(t);const s={type:a.MessageType.UPDATE_ICON,data:{isOverlayMode:t}};this.messageManager.send(s)}dispose(){this.element.classList.toggle(this.overlayMode.class,!1)}changeOverlayMode(e){this.element.classList.toggle(this.overlayMode.class,e),this.chatAppFrameSelector.changeOverlayMode(this.overlayMode.class,e),this.chatSelector.setHeight(),this.storage.set("overlay-mode",e)}static tryNew(){try{return new m}catch(e){return null}}}t.App=m},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(10),o=s(5),n=s(11),l=s(0);class i extends l.Selector{constructor(){super("ytd-live-chat-frame"),this.areaModeManager=new r.AreaModeManager,this.playerModeManager=new o.PlayerModeManager,this.playerSelector=new n.PlayerSelector,this.initialize()}initialize(){window.onresize=()=>{this.setHeight()},this.setAreaMode(0),this.setAreaKey()}setPlayerMode(e){switch(e){case 0:this.element.classList.add("player-default"),this.element.classList.remove("player-theater"),this.element.classList.remove("player-fullscreen");break;case 1:this.element.classList.remove("player-default"),this.element.classList.add("player-theater"),this.element.classList.remove("player-fullscreen");break;case 2:this.element.classList.remove("player-default"),this.element.classList.remove("player-theater"),this.element.classList.add("player-fullscreen")}this.setHeight()}setAreaMode(e){switch(e){case 0:this.element.classList.add("overlay-left"),this.element.classList.remove("overlay-right");break;case 1:this.element.classList.remove("overlay-left"),this.element.classList.add("overlay-right")}}setHeight(){setTimeout(()=>{let e=this.playerSelector.height;this.playerModeManager.isFullscreen?e-=60:e-=45;const t=`\n        max-height: ${e.toString()}px;\n        height: ${e.toString()}px;\n      `;this.element.setAttribute("style",t)},500)}setPlayerOndbclick(e){this.playerSelector.setOndbclick(e)}setAreaKey(){window.addEventListener("keydown",e=>{65===e.keyCode&&(this.areaModeManager.isLeft?this.setAreaMode(1):this.areaModeManager.isRight&&this.setAreaMode(0))})}}t.ChatSelector=i},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.AreaModeManager=class{get isLeft(){const e=this.element;return null===e||e.classList.contains("overlay-left")}get isRight(){const e=this.element;return null!==e&&e.classList.contains("overlay-right")}get element(){return document.getElementById("chat")}}},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0),o=s(12);class n extends r.Selector{constructor(){super(".html5-main-video"),this.playerContainerSelector=new o.PlayerContainerSelector}get height(){return this.playerContainerSelector.htmlElement.clientHeight}setOndbclick(e){this.htmlElements.forEach(t=>{t.ondblclick=e})}}t.PlayerSelector=n},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);class o extends r.Selector{constructor(){super(".html5-video-player")}}t.PlayerContainerSelector=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);class o extends r.Selector{constructor(){super("iframe#chatframe")}changeOverlayMode(e,t){this.innerDocument.body.classList.toggle(e,t)}get iframe(){const e=document.querySelector(this.query);if(null===e)throw new Error("DOM is not HTMLframeElement");return e}get innerDocument(){const e=this.iframe;if(null===e.contentWindow||null===e.contentWindow.document)throw new Error("document not found.");return e.contentWindow.document}}t.ChatAppFrameSelector=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);class o extends r.Selector{constructor(){super(".ytp-fullscreen-button")}setOnclick(e){this.htmlElements.forEach(t=>{t.onclick=e}),window.addEventListener("keydown",t=>{70===t.keyCode&&e()})}}t.FullscreenButtonSelector=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const r=s(0);class o extends r.Selector{constructor(){super(".ytp-size-button")}setOnclick(e){this.htmlElements.forEach(t=>{t.onclick=e}),window.addEventListener("keydown",t=>{84===t.keyCode&&e()})}}t.SizeButtonSelector=o},function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.Cookies=class{constructor(){this.cookies=this.getCookies()}get isWide(){return"1"===this.getValue("wide")}getValue(e){const t=this.getCookies().filter(t=>t.key===e)[0];return t?t.value:""}update(){this.cookies=this.getCookies()}getCookies(){return document.cookie.split("; ").map(e=>({key:e.split("=")[0],value:e.split("=")[1]}))}}},function(e,t,s){}]);